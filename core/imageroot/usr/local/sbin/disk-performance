#!/usr/bin/fio
#
# disk-performance -- Measure disk performances
#
# Version 2025-07-21
#
# PRE-REQUISITES
#
# - Additional software:
#
#      dnf install -y fio bc
#
# - Free disk space: ncpus * 2 GB, e.g. if the node has 2 CPUs, then 4 GB
#   of free disk space are required for the benchmark run.
#
# EXECUTION
#
# For example, the following command tests the disk mounted on the
# currently working directory and saves the benchmark output in
# ./perf.out
#
#     disk-performance | tee perf.out
#
# Print the source device for the currently working directory:
#
#     findmnt -T . -o SOURCE
#

[global]
ioengine=libaio
direct=1

[randrw]
group_reporting
time_based
numjobs=$ncpus
runtime=120s
ramp_time=10s
iodepth=16
iodepth_batch=$ncpus*2
unlink=1
readwrite=randrw
size=2G
buffer_compress_percentage=75
